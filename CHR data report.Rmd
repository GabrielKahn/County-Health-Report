---
title: "CHR Data"
author: "Gabriel Kahn"
date: "May 5, 2019"
output: pdf_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(stringr)
CHR_data <- read_csv("CHR_data.csv")

```
# Introduction

This report is intended to be the first step in a larger project analyzing how health and economic factors influence US presidential elections. Here, I will use data collected from County Health Rankings and Roadmaps, an organization formed as a partnership between the Robert Wood Johnson Foundation and the University of Wisconsin Population Health Institute. The purpose here is exploratory; the hope is to gain a more nuanced look at the nation's health at a county level, with a particular focus on swing states. As the data set contains information for only one year, 2018, I cannot make time comparisons to get a sense of whether or not conditions are getting better or worse. Instead, I can compare states and counties to find pockets of areas which may be facing health crises. Looking ahead, I hope to collect data on election results by county to see if health factors relate to election outcomes.


# Tidying Data
 
Here I tidy the data.

```{r}


rm(list = ls(all.names = TRUE))
# Clears environment so the remove function doesnt canibalize the data set
CHR_data <- read_csv("CHR_data.csv")
CHR_data <- CHR_data[-c(1) , ]
# remove the redundant first row
CHR_data <-
   data.frame(lapply(CHR_data, trimws), stringsAsFactors = FALSE) 
# Take spaces out of column names
CHR_data_num <- CHR_data                           
# Replicate data
CHR_data_num[ , 8:508] <- as.data.frame(   
    apply(CHR_data_num[ , 8:508], 2, as.numeric))
# Recode characters as numeric
States_data <- CHR_data_num[-c(1) , ] %>%
  filter(County.FIPS.Code == "000")
# Create data frame to for state wide comparison, removing first row for the whole country
swing_states_county <- CHR_data_num %>% 
  filter(State.Abbreviation == "CO" | State.Abbreviation == "FL" | State.Abbreviation == "IO"| State.Abbreviation == "MI"| State.Abbreviation == "MN"| State.Abbreviation == "NH" | State.Abbreviation == "NC" | State.Abbreviation == "NV" | State.Abbreviation == "OH"| State.Abbreviation == "PA"| State.Abbreviation == "VA")

swing_states <- swing_states_county %>% 
  filter(County.FIPS.Code == "000")
```

# Nutrition

I would like to begin this health report by taking a broader state comparison across numerous health categories.

## Statewide Nutrition Analysis

The County Health Rankings data set includes the Food Environment Index, a measurement broadly ranking a place's access to healthy food options. It takes into account several factors including income, proximity to grocery stores, and other measures which determine whether a population has access to healthy food options.

A population's nutrition levels can predict a wide variety of other health measures, from obesity rates to mental health, even premature death rates. 

```{r}

States_data %>% 
  ggplot(aes(reorder(State.Abbreviation, Food.environment.index.raw.value), Food.environment.index.raw.value)) +
  geom_col(fill = "blue") +
  theme_minimal() +
  theme(axis.text.x = element_text(face="bold", 
                           size=8, angle=90, vjust = -.05)) +
    labs(x = "State", y = "Food Environment Index", title = "Statewide Nutrition Index" )

```

The above chart gives a broad ranking of states based on their nutrition level. It shows that there is a rather large disparity between Mississippi and even states in the middle of the distribution. Further questions are also raised as to why some states are so poor in this regard. Is it that most of the states at the bottom are warm whether states? Does being a largely rural state influence access to food? Perhaps it is also the case that there are county disparities within states; for example richer areas in New York  may mask poor food indexes in other parts of the state.

Nonetheless, this chart will be helpful in future analysis, particularly when looking to see if swing states have similar charactoristics when it comes to health.



## County Nutrition Analysis

Going off the previous


```{r}
NY_data <- CHR_data_num %>% 
  filter(State.Abbreviation == "NY")

ggplot(NY_data, aes(reorder(Name, Food.environment.index.raw.value), Food.environment.index.raw.value)) +
  geom_col(fill = "red") +
  theme_minimal() +
  theme(axis.text.x = element_text(face="bold", 
                           size=8, angle=90, vjust = -.05)) +
    labs(x = "County", y = "Food Environment Index", title = "New York County Nutrition Index" )

```


```{r}
MI_data <- CHR_data_num %>% 
  filter(State.Abbreviation == "MI")

ggplot(NM_data, aes(reorder(Name, Food.environment.index.raw.value), Food.environment.index.raw.value)) +
  geom_col(fill = "red") +
  theme_minimal() +
  theme(axis.text.x = element_text(face="bold", 
                           size= 6, angle=90, vjust = -.05)) +
    labs(x = "County", y = "Food Environment Index", title = "Michigan County Nutrition Index" )

```